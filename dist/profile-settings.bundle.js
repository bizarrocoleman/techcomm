var ProfileSettings=function(){var e,a,t,n,s,r,d,i,l,o,c,u,p,m,h,v,f,C,g=$("#page-loader"),b=$("#hasPassword"),y={UpdateAccessSettings:"/api/User/UpdateAccessSettings",SetPassword:"/api/User/SetPassword",ChangeLanguage:"/api/User/UpdateLanguage",GetLicenseType:"/api/User/GetLicenseType",UpdateInvoiceData:"/api/User/UpdateInvoiceData",FetchInvoiceData:"/api/User/FetchInvoiceData"},w=function(){g.show()},x=function(){g.hide()},E=function(){function e(e){e?localStorage.setItem("checkAccountActive-"+a,"active"):(notify.message=locale.panel.accountNotActive,notify.type="inverse",notify.delay=1e4,notify.show())}var a=$("#idUser").val(),t=localStorage.getItem("checkAccountActive-"+a);null===t&&ApiGenially.executeCall("",y.checkAccountConfirmed,"GET",e)},T=function(){var e=navigator.language?navigator.language:navigator.userLanguage;moment.locale(e)},L=function(){$(window).scroll(function(e){var a=$(window).scrollTop();a>=200?$("div.scrollTop").fadeIn():a<200&&$("div.scrollTop").fadeOut()}),$("#scrollTop").on("click",function(e){$("html, body").animate({scrollTop:0},"slow")})},k=function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})},S=function(){function n(){setTimeout(function(){d.removeClass("bg-palette-blue").addClass("bgm-green"),d.find(".preloader").addClass("hidden"),d.find(".update-text").addClass("hidden"),d.find(".access-updated-text").removeClass("hidden"),setTimeout(function(){d.removeClass("bgm-green").addClass("bg-palette-blue"),d.find(".update-text").removeClass("hidden"),d.find(".access-updated-text").addClass("hidden"),d.removeClass("disabled")},1500)},800)}function r(){d.removeClass("bg-palette-blue").addClass("bgm-red"),d.find(".preloader").addClass("hidden"),d.find(".update-error").removeClass("hidden"),s.children(".password-mismatch").hide(),s.children(".update-error").show(),s.show(),setTimeout(function(){d.removeClass("bgm-red").addClass("bg-palette-blue"),d.find(".update-text").removeClass("hidden"),d.find(".update-error").addClass("hidden"),d.find(".access-updated-text").addClass("hidden"),d.removeClass("disabled")},1500)}var d=$(this),i=!1;if(""===e.val()?(e.parent().parent().addClass("has-error"),i=!0):e.parent().parent().hasClass("has-error")&&e.parent().parent().removeClass("has-error"),""===a.val()?(a.parent().parent().addClass("has-error"),i=!0):a.parent().parent().hasClass("has-error")&&a.parent().parent().removeClass("has-error"),""===t.val()?(t.parent().parent().addClass("has-error"),i=!0):t.parent().parent().hasClass("has-error")&&t.parent().parent().removeClass("has-error"),!i){if(a.val()!==t.val())return s.children(".password-mismatch").show(),s.children(".update-feedback").hide(),void s.show();s.hide(),d.addClass("disabled"),d.find(".preloader").removeClass("hidden"),d.find(".update-text").addClass("hidden");var l={OldPassword:e.val().trim(),NewPassword:a.val().trim(),ConfirmPassword:t.val().trim()};ApiGenially.executeCall(l,y.UpdateAccessSettings,"POST",n,r)}},D=function(){function e(){setTimeout(function(){r.removeClass("bg-palette-blue").addClass("bgm-green"),r.find(".preloader").addClass("hidden"),r.find(".update-text").addClass("hidden"),r.find(".access-updated-text").removeClass("hidden"),setTimeout(function(){r.removeClass("bgm-green").addClass("bg-palette-blue"),r.find(".update-text").removeClass("hidden"),r.find(".access-updated-text").addClass("hidden"),r.removeClass("disabled")},1500)},800)}function n(){r.removeClass("bg-palette-blue").addClass("bgm-red"),r.find(".preloader").addClass("hidden"),r.find(".update-error").removeClass("hidden"),s.children(".password-mismatch").hide(),s.children(".update-error").show(),s.show(),setTimeout(function(){r.removeClass("bgm-red").addClass("bg-palette-blue"),r.find(".update-text").removeClass("hidden"),r.find(".update-error").addClass("hidden"),r.find(".access-updated-text").addClass("hidden"),r.removeClass("disabled")},1500)}var r=$(this),d=!1;if(""===a.val()?(a.parent().parent().addClass("has-error"),d=!0):a.parent().parent().hasClass("has-error")&&a.parent().parent().removeClass("has-error"),""===t.val()?(t.parent().parent().addClass("has-error"),d=!0):t.parent().parent().hasClass("has-error")&&t.parent().parent().removeClass("has-error"),!d){if(a.val()!==t.val())return s.children(".password-mismatch").show(),s.children(".update-feedback").hide(),void s.show();s.hide(),r.addClass("disabled"),r.find(".preloader").removeClass("hidden"),r.find(".update-text").addClass("hidden");var i={NewPassword:a.val().trim(),ConfirmPassword:t.val().trim()};ApiGenially.executeCall(i,y.SetPassword,"POST",e,n)}},I=function(){var e=r.val();if("es"===e||"en"===e){var a=new Date;a.setDate(a.getDate()+1e3),document.cookie="_cultureLocalizationGeniallyV2="+e+"; expires="+a+"; path=/",swal({title:locale.profile.LanguageProfileTitle,text:locale.profile.LanguageProfileDescription+"\n\r\n\r"+locale.profile.LanguageProfileDescriptionSub,type:"success"},function(){location.reload()})}},P=function(){"es-ES"===C?r.selectpicker("val","es"):r.selectpicker("val","en")},A=function(e){var a=["Creaciones ilimitadas"],t=a.concat(["Descargar","Plantillas premium","Privacidad","Funcionalidades extra"]),n=t.concat(["Eliminar marca de agua","Estadísticas","Transferencia de creaciones","Formación Avanzada"]),s=n.concat(["Apoyo Diseñador"]),r=t,d=r.concat(["Formación Avanzada"]),i=["Unlimited creations"],l=i.concat(["Download","Premium Templates","Privacy","Extra functionalities"]),o=l.concat(["Remove watermark","Statistics","Transfer creations","Advanced training"]),c=o.concat(["Designer suppport"]),u=l,p=u.concat(["Advanced training"]);
// Display License features in the current language
if("es-ES"===C)switch(e){case 1:return a;case 2:return t;case 3:return n;case 4:return r;case 5:return d;case 6:return s}else if("en-US"===C)switch(e){case 1:return i;case 2:return l;case 3:return o;case 4:return u;case 5:return p;case 6:return c}else switch(e){case 1:return i;case 2:return l;case 3:return o;case 4:return u;case 5:return p;case 6:return c}},U=function(){function e(e){var a="";switch(e.LicenseRecurrent){case 1:a="es-ES"===C?"Mensual":"Monthly";break;case 2:
// Redirect to cancel paypal license page
a="es-ES"===C?"Anual":"Annual"}
// Set the License Type Name
switch(e.LicenseType){case 1:"es-ES"===C?i.html("Licencia Gratuita"):i.html("Free License"),o.remove(),u.hide();break;case 2:"es-ES"===C?i.html("Licencia PRO "+a):i.html("PRO License "+a);break;case 3:"es-ES"===C?i.html("Licencia Master "+a):i.html("Master License "+a);break;case 4:"es-ES"===C?i.html("Licencia EDU "+a):i.html("EDU License "+a);break;case 5:"es-ES"===C?i.html("Licencia Team EDU "+a):i.html("EDU Team License "+a);break;case 6:"es-ES"===C?i.html("Licencia Team "+a):i.html("Team License "+a);break;default:"es-ES"===C?i.html("Licencia Gratuita"):i.html("Free License")}switch(e.PaymentChannel){case 0:o.remove();break;case 1:var t=function(e){function a(){return $.ajax({url:"/License/CancelSubscription",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json"})}function t(e){""!==e&&(notify.message=locale.panel.expiredTime+e+". ",notify.type="success",notify.delay=5e3,notify.show(),c.removeClass("disabled"))}function n(e){notify.message=locale.generic.mErrorProcessingMessage,notify.type="danger",notify.show(),c.removeClass("disabled")}e.preventDefault(),c.addClass("disabled"),a().done(t).fail(n)};c.attr("href","#"),c.click(t);break;case 2:
// Redirect to cancel paypal license page
c.attr("href","/License/Cancel")}
// Set the License Expiry Date
var n=new Date(e.ExpiryDate),s=new Date("01/01/2000");n<s?u.hide():l.html(new Date(e.ExpiryDate).toLocaleDateString());
// Generate the License Type
var r=A(e.LicenseType);r.forEach(function(e){d.append("<li>"+e+"</li>")})}ApiGenially.executeCall("",y.GetLicenseType,"GET",e)},B=function(){function e(){setTimeout(function(){t.removeClass("bg-palette-blue").addClass("bgm-green"),t.find(".preloader").addClass("hidden"),t.find(".update-invoice-text").addClass("hidden"),t.find(".invoice-updated-text").removeClass("hidden"),setTimeout(function(){t.removeClass("bgm-green").addClass("bg-palette-blue"),t.find(".update-invoice-text").removeClass("hidden"),t.find(".invoice-updated-text").addClass("hidden"),t.removeClass("disabled")},1500)},800)}function a(){t.removeClass("bg-palette-blue").addClass("bgm-red"),t.find(".preloader").addClass("hidden"),t.find(".update-invoice-error").removeClass("hidden"),setTimeout(function(){t.removeClass("bgm-red").addClass("bg-palette-blue"),t.find(".update-invoice-text").removeClass("hidden"),t.find(".update-invoice-error").addClass("hidden"),t.find(".invoice-updated-text").addClass("hidden"),t.removeClass("disabled")},1500)}var t=$(this),n=!1;if(""===p.val()?(p.parent().parent().addClass("has-error"),n=!0):p.parent().parent().hasClass("has-error")&&p.parent().parent().removeClass("has-error"),""===m.val()?(m.parent().parent().addClass("has-error"),n=!0):m.parent().parent().hasClass("has-error")&&m.parent().parent().removeClass("has-error"),""===h.val()?(h.parent().parent().addClass("has-error"),n=!0):h.parent().parent().hasClass("has-error")&&h.parent().parent().removeClass("has-error"),""===v.val()||null===v.val()?(v.parent().parent().next().removeClass("hidden"),n=!0):v.parent().parent().next().addClass("hidden"),!n){t.addClass("disabled"),t.find(".preloader").removeClass("hidden"),t.find(".update-invoice-text").addClass("hidden");var s={Name:p.val(),Cif:m.val(),Address:h.val(),Country:v.val()};ApiGenially.executeCall(s,y.UpdateInvoiceData,"POST",e,a)}},G=function(){"1"===b.val()?n.click(S):n.click(D),r.on("changed.bs.select",I),f.click(B)},F=function(){function e(e){p.val(e.Name),h.val(e.Address),m.val(e.Cif),v.val(e.Country),v.selectpicker("val",e.Country)}ApiGenially.executeCall("",y.FetchInvoiceData,"GET",e)},O=function(){w(),e=$(document.getElementById("account-current-password")),a=$(document.getElementById("account-new-password")),t=$(document.getElementById("account-again-password")),n=$(document.getElementById("account-update")),s=$(document.getElementById("error-feeback")).hide(),r=$(document.getElementById("account-language")),
// License Features Related Fields
d=$(document.getElementById("license-features")),i=$(".license-type-name"),l=$(document.getElementById("license-type-expiry")),o=$(document.getElementById("panel-cancel")),c=$(document.getElementById("button-cancel-final")),u=$(document.getElementById("license-expiry-block")),p=$(document.getElementById("invoice-business")),m=$(document.getElementById("invoice-tax-number")),h=$(document.getElementById("invoice-address")),v=$(document.getElementById("invoice-country")),f=$(document.getElementById("update-invoice-data")),helper.beautifulInputText(),helper.wavesButtons(),T(),L(),k(),r.selectpicker(),v.selectpicker(),G(),$(".contracted-logo").click(function(){$("html, body").animate({scrollTop:0},"slow")}),C=language,P(),U(),F(),x()};return{initialize:O,showLoader:w,hideLoader:x,checkAccountConfirmed:E}}();$(document).ready(function(){ProfileSettings.initialize();var e=$(window).scrollTop(),a=$("#header");e>20&&a.addClass("contracted"),e>180&&a.children(".brand").addClass("contracted")}),$(window).scroll(function(){var e=$(window).scrollTop(),a=$("#header");e>20?a.addClass("contracted"):a.removeClass("contracted"),e>180?a.children(".brand").addClass("contracted"):a.children(".brand").removeClass("contracted")});